#!/usr/bin/env python3
  
if __name__ == "__main__":

  import logging
  import argparse

  from grib_downloader.utils import subsetGrib

  parser = argparse.ArgumentParser(description='GRIB file subsetter')
  parser.add_argument('local',       type = str, help = 'Local file path to write downloaded data to')
  parser.add_argument('patterns',    type =str, nargs='*', help = 'Used to filter the variables to be download. Any number of patterns to match to grib records in the idx file for downloading' )
  parser.add_argument('--log-level', type =int, default=20, help = 'Set logging level')
  parser.add_argument('--no-idx',        action='store_true', help = 'Do NOT save the .idx file locally')

  args = parser.parse_args()

  stream = logging.StreamHandler()
  stream.setLevel( args.log_level )
  stream.setFormatter( logging.Formatter( '%(asctime)s [%(levelname)s] %(message)s' ) )
  LOG.addHandler( stream )

  res = subsetGrib( args.local, *args.patterns, no_idx = args.no_idx )

  exit( not res )

